{{ define "main" }}

{{/* Schema.org PodcastSeries */}}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "PodcastSeries",
  "name": {{ .Title | jsonify }},
  "description": {{ .Content | plainify | truncate 160 | jsonify }},
  "url": {{ .Permalink | jsonify }},
  "author": {
    "@type": "Person",
    "name": {{ .Site.Params.podcast.author | default .Site.Params.author | jsonify }}
  },
  "image": {{ "/img/logo.webp" | absURL | jsonify }}
}
</script>

<section class="bg-primary md:px-30 pt-12 py-6">
    <div class="block w-fit mx-auto bg-accent-primary text-white text-sm font-medium px-3 py-1 rounded-full mb-4 animate-on-scroll-fade-up">
        Podcasts
    </div>
    <h2 class="text-center text-primary font-bold mb-4 text-3xl">{{ .Title }}</h2>
    <div class="text-primary p-3 prose prose-lg max-w-none mx-auto animate-on-scroll-fade-up animate-stagger-2">{{ .Content }}</div>
</section>

<section class="bg-primary p-6 sm:p-12 bg-secondary">    
    <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        
        {{ range .Pages.ByDate.Reverse }}
        {{- $ep := partial "podcasts/episode-data" . -}}

        {{/* Desktop view */}}
        <div class="hidden md:block">
            <a href="{{ $ep.permalink }}" class="flex flex-col h-full bg-primary shadow-lg hover:shadow-2xl transition duration-500 hover:scale-102 border-2 border-accent hover:border-2 hover:border-accent-hover overflow-hidden">
                
                <img src="{{ $ep.image }}" alt="Couverture de l'épisode {{ $ep.title }}" class="w-full h-48 object-cover">

                <div class="p-6 flex flex-col flex-grow">
                    <p class="text-tertiary uppercase mb-1">{{ $ep.subtitle | default "Épisode" }}</p>
                    <h3 class="text-secondary font-bold mb-2">{{ $ep.title }}</h3>
                    <p class="text-primary mb-3 text-sm">
                        {{ $ep.description | plainify | truncate 100 }}...
                    </p>
                    
                    <div class="mt-auto flex flex-wrap justify-between items-center gap-2 text-xs text-text-primary border-t border-accent-primary pt-3">
                        <p class="inline-block bg-accent-primary text-secondary text-xs font-medium px-2 py-1 rounded-full whitespace-nowrap">
                            S{{ $ep.season }}E{{ $ep.episode_number }}
                        </p>
                        <div class="flex items-center whitespace-nowrap">
                            <span class="material-symbols-outlined mr-1 text-base">timer</span>
                            <p>{{ .Params.duration | default "00:00" }}</p>
                        </div>
                        <div class="flex items-center whitespace-nowrap">
                            <span class="material-symbols-outlined mr-1 text-base">calendar_today</span>
                            <p>{{ $ep.date.Format "02/01/06" }}</p>
                        </div>
                    </div>
                </div>
            </a>         
        </div> 

        {{/* Mobile view */}}
        <div class="md:hidden">
            <a href="{{ $ep.permalink }}" class="relative block h-52 gap-2 border-2 border-accent overflow-hidden shadow-lg animate-on-scroll-fade-up">
            
                <img src="{{ $ep.image }}" alt="{{ $ep.title }}" class="absolute inset-0 w-full h-full object-cover">
                <div class="absolute inset-0 bg-black/30"></div>
            
                <div class="relative h-full flex flex-col justify-between p-3">
                    <div>
                        <p class="inline-block bg-accent-primary text-secondary text-xs font-medium px-2 py-1 rounded-full">
                            S{{ $ep.season }}E{{ $ep.episode_number }}
                        </p>
                    </div>
            
                    <div>
                        <h4 class="text-text-inverse font-bold text-sm leading-tight mb-1">
                            {{ $ep.title }}
                        </h4>
                        <p class="text-text-inverse font-bold text-sm leading-tight mb-1">
                            {{ $ep.subtitle | default "Épisode" }}
                        </p>

                        <div class="flex items-center gap-1 text-text-inverse text-xs">
                            <span class="material-symbols-outlined icon-xs icon-inverse">timer</span>
                            <p>{{ .Params.duration | default "00:00" }}</p>
                            <span class="material-symbols-outlined ml-4 mr-1 text-base">calendar_today</span>
                            <p>{{ $ep.date.Format "02/01/06" }}</p>
                        </div>
                    </div>
                </div>
            </a>
        </div> 
        {{ end }}
    </div>
</section>

{{ end }}